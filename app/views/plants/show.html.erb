<div class="w-50 mx-auto">
  <div>
    <%= link_to "< Retour", plants_path, class:"text-decoration-none text-black mb-3 mt-2" %>
  </div>
    <div class="d-flex justify-content-between align-items-center">
      <div class="left-part">
        <h2><%= @plant.name %></h2>
        <p><%= @plant.categorie %></p>
      </div>
      <div class="btn-group rounded h-25">
      <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#exampleModal" type="button">
        Ajouter à ma liste
      </button>

<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title text-center" id="exampleModalLabel">Mes listes</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
       <% if user_signed_in?  %>
        <div class="modal-body">
          <div class="">
            <div class="d-flex flex-column p-2">
              <% @lists.each do |list|%>
              <div class="d-flex align-items-center justify-content-between">
                <%= link_to "#{list.nom}", lists_url %>
                <%= button_to "+", list_plant_lists_url(plant_id: @plant.id, list_id: list.id), class:"fs-2 text-success border-0 bg-transparent text-decoration-none" %>
              </div>
              <% end %>
            </div>
          </div>
          <h4 class="text-center">Créer une liste</h4>
          <%= simple_form_for @list do |f| %>
            <div class="mb-3">
              <%= f.label :nom %>
              <%= f.text_field :nom, class:"form-control"%>
            </div>
            <div class="d-flex justify-content-center">
              <%= f.button :submit, "Créer", class:"mb-2 text-decoration-none btn btn-success" %>
            </div>
          <% end %>
      </div>
      <% else %>
        <div class="d-flex justify-content-center align-items-center flex-column py-5">
          <p>Connectez-vous pour ajouter ou créer votre liste</p>
          <button class="btn btn-primary"><a class="text-decoration-none  text-white" href="/users/sign_in">Se connecter</a></button>
        </div>
      <% end %>
    </div>
  </div>
</div>
    </div>

  </div>
    <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel" style="height:400px;">
    <div class="carousel-indicators">
      <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
      <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
      <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
    </div>
    <div class="carousel-inner" style="height:400px;">
      <div class="carousel-item active">
        <%= cl_image_tag @plant.photos.first.key, :cloud_name => "dzhzzutmq", class: "w-100 rounded-3 mb-3 d-flex m-auto" %>
      </div>
      <div class="carousel-item">
        <%= cl_image_tag @plant.photos.second.key, :cloud_name => "dzhzzutmq", class: "w-100 rounded-3 mb-3 m-1 object-fit-cover" %>
      </div>
      <div class="carousel-item">
        <%= cl_image_tag @plant.photos.third.key, :cloud_name => "dzhzzutmq", class: "w-100 rounded-3 mb-3 m-1 object-fit-cover" %>
      </div>
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Next</span>
    </button>
  </div>

  <div data-controller="tabs" data-tabs-active-class="bg-warning" data-tabs-default-tab-value="tab1" class="mt-3">
    <div class="flex">
      <button id="tab1" data-tabs-target="btn" data-action="click->tabs#select" class="border-0 rounded-top p-3">Description</button>
      <button id="tab2" data-tabs-target="btn" data-action="click->tabs#select" class="border-0 rounded-top p-3">Caractéristiques</button>
      <button id="tab3" data-tabs-target="btn" data-action="click->tabs#select" class="border-0 rounded-top p-3">Maladies</button>
    </div>
    <div data-tabs-target="tab" id="tab1">
      <div class="card mb-3 bg-warning border-0" style="height: auto;">
        <div class="card-body mb-3">
          <div class="lh-sm">
            <p><strong>Nom scientifique:</strong> <%= @plant.nom_scientifique %> <br>
            <i class="fa-brands fa-pagelines me-3" title="Famille"></i><%= @plant.famille %> <br>
            <i class="fa-solid fa-star-half-stroke me-2" title="Difficulté"></i> <%= @plant.difficulte %></p>
          </div>
          <p><%= @plant.description %></p>
          <p><strong>Conseils de semis:</strong> <%= @plant.conseil_semis %></p>
          <p><strong>Conseils de culture:</strong> <%= @plant.conseil_culture %></p>
        </div>
    </div>
  </div>
  <div data-tabs-target="tab" id="tab2" class="">
      <div class="card mb-3 bg-warning border-0" style="height: 300px;">
        <div class="card-body mb-3 lh-base">
            <p><i class="fa-solid fa-seedling me-3" title="Types de semis"></i><%= @plant.type_semis %><br>
            <i class="fa-regular fa-calendar-plus me-3" title="Periode de semis"></i><%= @plant.periode_semis %><br>
            <i class="fa-regular fa-calendar-check me-3" title="Récoltes"></i><%= @plant.periode_recoltes %><br>
            <i class="fa-solid fa-cloud-sun me-2" title="Exposition"></i><%= @plant.exposition %><br>
            <i class="fa-solid fa-droplet me-3" title="Besoin en eau"></i><%= @plant.besoin_eau %><br>
            <i class="fa-solid fa-arrow-up me-3" title="Hauteur"></i><%= @plant.hauteur %> <br>
            <i class="fa-solid fa-arrows-left-right me-2" title="Ecart entre les plantes"></i><%= @plant.ecart_rang %><br>
            <i class="fa-solid fa-temperature-low me-2" title="Température"></i><%= @plant.temperature %><br>
            <strong>Culture:</strong> <%= @plant.culture %><br>
            <strong>Nature du sol:</strong> <%= @plant.nature_sol %><br>
            <strong>Qualité du sol:</strong> <%= @plant.qualite_sol %><br></p>
        </div>
    </div>
  </div>
    <div data-tabs-target="tab" id="tab3" class="">
      <div class="card mb-3 bg-warning border-0" style="height: 300px;">
        <div class="card-body mb-3">
            <p><strong>Maladies:</strong> <%= @plant.maladie %></p>
        </div>
      </div>
    </div>
  <div class="test-1">
    <h5 class="d-flex flex-row"><i class="fa-regular fa-pen-to-square"></i><span class="text-decoration-underline ms-2">Conseils des jardiniers :</span> </h5>
      <% if @tips.present? %>
        <% @tips.each do |tip| %>
         <div class="p-3 rounded mb-5" style="background-color: #f0fff4;">
          <div class="">
           <strong>Par <%= tip.user.prenom %> <%= tip.user.nom %> :</strong>
          </div>
         <p class="text-decoration-underline fst-italic"><strong><%= tip.titre %></strong></p>
          <p><%= tip.contenu %></p>
         </div>
        <% end %>
      <% else %>
      <div class="test-2">
        <p class="fst-italic p-3 d-flex flex-column align-items-center justify-content-center rounded mb-3" style="background-color: #f0fff4;">Pas de conseils sur cette plante.. Soyez le premier à donner vos trucs et astuces pour aider les jardiniers de When To Plant !</p>
      </div>
      <% end %>
  </div>

  <% if user_signed_in?  %>
    <div class="card mb-5 p-3 w-75 m-auto" style="background-color: #f0fff4;">
      <h4 class="text-center">Ajouter votre conseil</h4>
      <%= simple_form_for([@plant, @tip]) do |f| %>
        <%= f.input :titre %>
        <%= f.input :contenu %>
          <div class="d-flex justify-content-end">
            <%= f.submit "Publier", class:"btn btn-success text-white w-25" %>
          </div>
      <% end %>
    </div>
  <% else %>
    <div class="p-3 d-flex flex-column align-items-center justify-content-center rounded mb-5" style="background-color: #daf1df;">
      <p>Connectez-vous pour ajouter vos conseils !</p>
      <button class="btn btn-primary"><a class="text-decoration-none  text-white" href="/users/sign_in">Se connecter</a></button>
    </div>
  <% end %>

    <div class="mb-5 bg-success p-3 text-white">
      <h3 class="text-center">Bon voisins</h3>
    </div>

    <div class="cards mt-3">
      <% @bon_voisin.each do |bon_voisin| %>
        <div class="card rounded-3" style="box-shadow: 0 0 15px rgba(0,0,0,0.2); background-color: #daf1df; border-radius:12px;">
          <%= cl_image_tag bon_voisin.plant_2.photos.first.key, :cloud_name => "dzhzzutmq", style: 'height: 250px; width: 100%; object-fit: cover; padding: 16px 16px 0 16px;' %>
          <div class="card-body ">
            <h5 class="card-title"><%= bon_voisin.plant_2.name %></h5>
            <h6 class="card-title"><%= bon_voisin.plant_2.categorie %></h6>
            <p class="card-text text-muted fs-6"><%= bon_voisin.plant_2.description.truncate(200) %></p>
            <div class="d-flex justify-content-center">
              <%= link_to "Voir détails", plant_path(bon_voisin.plant_2), class:"btn btn-success text-white" %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
